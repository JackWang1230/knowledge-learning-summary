package cn.wr.udf;

import com.alibaba.fastjson.JSONObject;
import org.apache.hadoop.hive.ql.exec.UDF;

import java.util.Map;

/**
 * @author RWang
 * @Date 2022/2/25
 */

public class Json2StringDemoUdf extends UDF {

    public String evaluate(String  jsonString){
        StringBuilder sb = new StringBuilder();
        try {
            JSONObject jsonObject = JSONObject.parseObject(jsonString);
            for (Map.Entry<String, Object> entry : jsonObject.entrySet()){
                sb.append(entry.getValue()).append("#$#");
            }
        }catch (Exception e){
            e.printStackTrace();
            return null;
        }
        return sb.substring(0, sb.toString().length()-3);
    }

    public static void main(String[] args) {
        String a ="{\"47af61e6fbd42f704366c09304f8f62e\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"47af61e6fbd42f704366c09304f8f62e\",\"shops\":[{\"tradeCode\":\"6934277610157\",\"drugName\":\"红药气雾剂\",\"commonName\":\"红药气雾剂\",\"showName\":\"\",\"brand\":\"沈阳红药集团\",\"price\":\"63.20\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958081727.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958089133.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958086638.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958093089.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958095282.jpg\"],\"manufacturer\":\"沈阳红药精诚药业有限公司\",\"approvalNumber\":\"国药准字Z21021527\",\"description\":\"活血逐瘀，消肿止痛。用于跌打损伤，局部瘀血肿胀，筋骨疼痛。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"1180032\",\"realTradeCode\":\"6934277610157\",\"realCommonName\":\"红药气雾剂\",\"form\":\"60g\",\"pack\":\"瓶\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6934277610157\",\"drugName\":\"红药气雾剂\",\"commonName\":\"红药气雾剂\",\"showName\":\"沈阳红药集团 红药气雾剂\",\"brand\":\"沈阳红药集团\",\"price\":\"63.20\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958081727.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958089133.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958086638.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958093089.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1603958095282.jpg\"],\"manufacturer\":\"沈阳红药精诚药业有限公司\",\"approvalNumber\":\"国药准字Z21021527\",\"description\":\"活血逐瘀，消肿止痛。用于跌打损伤，局部瘀血肿胀，筋骨疼痛。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"红药气雾剂\",\"form\":\"60g\",\"pack\":\"瓶\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342162,\"isDisplay\":true,\"selectForm\":\"\"},\"15a13255b21f82f786998231f091ba88\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"15a13255b21f82f786998231f091ba88\",\"shops\":[{\"tradeCode\":\"6925399401372\",\"drugName\":\"红药贴膏\",\"commonName\":\"红药贴膏\",\"showName\":\"\",\"brand\":\"沈阳红药集团\",\"price\":\"74.60\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569421493945.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569421497948.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422141790.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422145293.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422151277.jpg\"],\"manufacturer\":\"沈阳红药集团股份有限公司\",\"approvalNumber\":\"国药准字Z10880021\",\"description\":\"祛瘀生新，活血止痛。用于跌打损伤，筋骨瘀痛。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"2123982\",\"realTradeCode\":\"6925399401372\",\"realCommonName\":\"红药贴膏\",\"form\":\"7cm*10cm*4贴*3袋\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6925399401372\",\"drugName\":\"红药贴膏\",\"commonName\":\"红药贴膏\",\"showName\":\"沈阳红药集团 红药贴膏\",\"brand\":\"沈阳红药集团\",\"price\":\"74.60\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569421493945.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569421497948.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422141790.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422145293.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1569422151277.jpg\"],\"manufacturer\":\"沈阳红药集团股份有限公司\",\"approvalNumber\":\"国药准字Z10880021\",\"description\":\"祛瘀生新，活血止痛。用于跌打损伤，筋骨瘀痛。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"红药贴膏\",\"form\":\"7cm*10cm*4贴*3袋\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342162,\"isDisplay\":true,\"selectForm\":\"\"},\"6f0ea5549c9b656d6bde4825360c5acb\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"6f0ea5549c9b656d6bde4825360c5acb\",\"shops\":[{\"tradeCode\":\"6959704600396\",\"drugName\":\"\",\"commonName\":\"科美丽康给药器\",\"showName\":\"\",\"brand\":\"\",\"price\":\"35.00\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1574996380468.jpg\"],\"manufacturer\":\"青岛科美生物工程有限公司\",\"approvalNumber\":\"鲁青械备20140003号\",\"description\":\"\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"2165544\",\"realTradeCode\":\"6959704600396\",\"realCommonName\":\"科美丽康给药器\",\"form\":\"1支装(KMGYQ-02针筒型婴儿喂药器)\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6959704600396\",\"drugName\":\"\",\"commonName\":\"科美丽康给药器\",\"showName\":\"科美丽康给药器\",\"brand\":\"\",\"price\":\"35.00\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1574996380468.jpg\"],\"manufacturer\":\"青岛科美生物工程有限公司\",\"approvalNumber\":\"鲁青械备20140003号\",\"description\":\"\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"科美丽康给药器\",\"form\":\"1支装(KMGYQ-02针筒型婴儿喂药器)\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342162,\"isDisplay\":true,\"selectForm\":\"\"},\"c99ee80cc6583f55073a19dd2bcd37f1\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"c99ee80cc6583f55073a19dd2bcd37f1\",\"shops\":[{\"tradeCode\":\"6927752323895\",\"drugName\":\"健胃消食片\",\"commonName\":\"健胃消食片\",\"showName\":\"\",\"brand\":\"济药\",\"price\":\"24.80\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897968212.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897971605.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897979627.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897976869.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1590653832604.jpg\"],\"manufacturer\":\"河南济源济世药业有限公司\",\"approvalNumber\":\"国药准字Z41020142\",\"description\":\"健胃消食。用于脾胃虚弱所致的食积、症见不思饮食、嗳腐酸臭、脘腹胀满;消化不良见上述证候者。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"2011586\",\"realTradeCode\":\"6927752323895\",\"realCommonName\":\"健胃消食片\",\"form\":\"0.5g*100T\",\"pack\":\"瓶\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6927752323895\",\"drugName\":\"健胃消食片\",\"commonName\":\"健胃消食片\",\"showName\":\"济药 健胃消食片\",\"brand\":\"济药\",\"price\":\"24.80\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897968212.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897971605.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897979627.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557897976869.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1590653832604.jpg\"],\"manufacturer\":\"河南济源济世药业有限公司\",\"approvalNumber\":\"国药准字Z41020142\",\"description\":\"健胃消食。用于脾胃虚弱所致的食积、症见不思饮食、嗳腐酸臭、脘腹胀满;消化不良见上述证候者。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"健胃消食片\",\"form\":\"0.5g*100T\",\"pack\":\"瓶\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342164,\"isDisplay\":true,\"selectForm\":\"\"},\"13cc6cc34fa558befd9de749eb531565\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"13cc6cc34fa558befd9de749eb531565\",\"shops\":[{\"tradeCode\":\"6945696500011\",\"drugName\":\"玫瑰花口服液\",\"commonName\":\"玫瑰花口服液\",\"showName\":\"\",\"brand\":\"昆仑维药\",\"price\":\"184.00\",\"img\":[],\"manufacturer\":\"喀什昆仑维吾尔药业股份有限公司\",\"approvalNumber\":\"国药准字Z65020019\",\"description\":\"补益支配器官。用于心慌气短，胃痛呕吐，神疲乏力。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"2190893\",\"realTradeCode\":\"6945696500011\",\"realCommonName\":\"玫瑰花口服液\",\"form\":\"10ml*10支\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6945696500011\",\"drugName\":\"玫瑰花口服液\",\"commonName\":\"玫瑰花口服液\",\"showName\":\"昆仑维药 玫瑰花口服液\",\"brand\":\"昆仑维药\",\"price\":\"184.00\",\"img\":[],\"manufacturer\":\"喀什昆仑维吾尔药业股份有限公司\",\"approvalNumber\":\"国药准字Z65020019\",\"description\":\"补益支配器官。用于心慌气短，胃痛呕吐，神疲乏力。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"玫瑰花口服液\",\"form\":\"10ml*10支\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342166,\"isDisplay\":true,\"selectForm\":\"\"},\"47e9cfdd715a165eb0edad53cc078003\":{\"scene\":\"2\",\"isPreTime\":\"\",\"sourceTradeCode\":\"47e9cfdd715a165eb0edad53cc078003\",\"shops\":[{\"tradeCode\":\"6925399403109\",\"drugName\":\"红药片\",\"commonName\":\"红药片\",\"showName\":\"\",\"brand\":\"沈阳红药\",\"price\":\"54.80\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741401593.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409191.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741408105.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409000.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409314.jpg\"],\"manufacturer\":\"沈阳红药集团股份有限公司\",\"approvalNumber\":\"国药准字Z21020597\",\"description\":\"活血止痛，去瘀生新，用于跌打损伤，瘀血肿痛，风湿麻木。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"578\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"132706\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"00:00:00\",\"storeEndTime\":\"23:59:00\",\"goodsInternalId\":\"2166565\",\"realTradeCode\":\"6925399403109\",\"realCommonName\":\"红药片\",\"form\":\"0.26g*40T*2袋\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"scene\":\"2\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false}],\"tradeCode\":\"6925399403109\",\"drugName\":\"红药片\",\"commonName\":\"红药片\",\"showName\":\"沈阳红药 红药片\",\"brand\":\"沈阳红药\",\"price\":\"54.80\",\"img\":[\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741401593.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409191.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741408105.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409000.jpg\",\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1606741409314.jpg\"],\"manufacturer\":\"沈阳红药集团股份有限公司\",\"approvalNumber\":\"国药准字Z21020597\",\"description\":\"活血止痛，去瘀生新，用于跌打损伤，瘀血肿痛，风湿麻木。\",\"isPrescription\":false,\"projectId\":\"2\",\"merchantId\":\"0\",\"merchantStatus\":\"1\",\"merchantIsPrescription\":\"1\",\"storeId\":\"0\",\"shopStatus\":\"1\",\"storeDistance\":\"3.00\",\"storeStartTime\":\"\",\"storeEndTime\":\"\",\"goodsInternalId\":\"\",\"realTradeCode\":\"\",\"realCommonName\":\"红药片\",\"form\":\"0.26g*40T*2袋\",\"pack\":\"盒\",\"sales\":\"0.00\",\"channel\":\"2\",\"distance\":\"\",\"goodsSignType\":\"advisor\",\"isOffShelf\":false,\"quantity\":1,\"createTime\":1609342166,\"isDisplay\":true,\"selectForm\":\"\"}}\t";
        try {
            Json2StringDemoUdf json2StringDemoUdf = Json2StringDemoUdf.class.newInstance();
            String evaluate = json2StringDemoUdf.evaluate(a);
            System.out.println(evaluate);
        } catch (InstantiationException | IllegalAccessException e) {
            e.printStackTrace();
        }

    }
}
