package cn.wr.test;

import org.apache.kafka.clients.producer.KafkaProducer;
import org.apache.kafka.clients.producer.Producer;
import org.apache.kafka.clients.producer.ProducerRecord;

import java.util.Properties;


public class TestKafkaProducer {
    private static final String json = "{\"barcode\":\"12312331\",\"channelList\":[{\"buyLimitState\":0,\"buyLink\":\"https://wx.turboradio.cn/dealnj/goodsDetail?skuNo=539-768842896907436032&channel=7&saleMerchantId=539&saleStoreId=74596\",\"channel\":7,\"configSkuId\":11427041792578,\"deleted\":0,\"detailsCode\":\"51c181c3caf711e98cfc049226c12d63\",\"goodsCenterId\":\"15415993065\",\"goodsName\":\"lhr-一百万权益\",\"goodsNo\":\"539-768842896907436032\",\"goodsSpuNo\":\"539-768842896907436032\",\"goodsSubType\":21,\"goodsType\":2,\"id\":\"15415993065\",\"integralState\":1,\"internalId\":\"20399\",\"merchantId\":539,\"merchantName\":\"药联健康\",\"priceState\":0,\"redisGoodsDetails\":{\"content\":\"123123131313\",\"coverImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-JTbKs4.jpeg\",\"deleted\":\"0\",\"detailsCode\":\"51c181c3caf711e98cfc049226c12d63\",\"detailsImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-K5Ci3C.jpeg,https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1585208883903.jpg\",\"iconImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-JTbKs4.jpeg\",\"id\":\"168\",\"richDesc\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928978314.txt\",\"serviceContent\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928977518.txt\",\"serviceDetails\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928977811.txt\",\"title\":\"APOE心脑血管风险基因检测\"},\"saleIntegral\":0.00,\"salePrice\":1.00,\"saleState\":0,\"salesChannel\":7,\"skuChannel\":\"539-768842896907436032-7\",\"skuNo\":\"539-768842896907436032\",\"stock\":123123123.000000,\"stockState\":1,\"storeId\":74596,\"storeName\":\"增值服务商城\",\"useDefaultDetail\":1}],\"deliveryMerchantId\":539,\"deliveryMerchantName\":\"药联健康\",\"detailsCode\":\"51c181c3caf711e98cfc049226c12d63\",\"externalCode\":\"123123\",\"goodsSubType\":21,\"goodsSubTypeName\":\"药联权益\",\"goodsType\":2,\"goodsTypeName\":\"药联权益\",\"id\":\"11427041792578\",\"item\":{\"backPrice\":1000000.00,\"claimamount\":0.00,\"gmtupdated\":1603347959000,\"groupId\":2685,\"id\":\"452371\",\"name\":\"lhr一百万\",\"redisService\":{\"categoryId\":99,\"claimamount\":0.00,\"gmtupdated\":1603347947000,\"icon\":\"\",\"iconyellow\":\"\",\"id\":\"422439\",\"name\":\"lhr一百万\",\"status\":1,\"tableId\":\"1441\"},\"serviceId\":1441,\"status\":1,\"tableId\":\"20399\"},\"itemCategory\":\"OTHER\",\"merchantId\":539,\"merchantName\":\"药联健康\",\"originPrice\":1.00,\"originTableId\":\"20399\",\"price\":1.00,\"redisAttrs\":[],\"redisBuyLimit\":[],\"redisGoodsDetails\":{\"content\":\"123123131313\",\"coverImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-JTbKs4.jpeg\",\"deleted\":\"0\",\"detailsCode\":\"51c181c3caf711e98cfc049226c12d63\",\"detailsImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-K5Ci3C.jpeg,https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1585208883903.jpg\",\"iconImg\":\"https://uniondrug-ota.oss-cn-shanghai.aliyuncs.com/APOE心脑血管风险检测-头图-JTbKs4.jpeg\",\"id\":\"168\",\"richDesc\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928978314.txt\",\"serviceContent\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928977518.txt\",\"serviceDetails\":\"https://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/test/1598928977811.txt\",\"title\":\"APOE心脑血管风险基因检测\"},\"refNo\":\"20399\",\"settlementDiscountType\":1,\"skuNo\":\"539-768842896907436032\",\"source\":0,\"specName\":\"123123\",\"state\":0,\"stock\":123123123.000000,\"stockId\":28521,\"title\":\"lhr-一百万权益\"}";

    // polardb
    private static final String update = "{\"data\":[{\"id\":\"54274596\",\"db_id\":\"118\",\"table_id\":\"34213\",\"goods_internal_id\":\"1110276\",\"group_id\":\"HWI00000006\",\"price\":\"36.80\",\"status\":\"0\",\"created_at\":\"2019-08-19 16:02:39\",\"updated_at\":\"2021-01-12 22:42:52\",\"gmtcreated\":\"2020-11-19 15:43:30\",\"gmtupdated\":\"2021-01-12 22:42:52\",\"member_price\":\"36.80\"}],\"database\":\"uniondrug_partner\",\"es\":1610462572000,\"id\":5780154,\"isDdl\":false,\"mysqlType\":{\"id\":\"int(11)\",\"db_id\":\"int(11)\",\"table_id\":\"int(11)\",\"goods_internal_id\":\"varchar(64)\",\"group_id\":\"varchar(32)\",\"price\":\"decimal(10,2)\",\"status\":\"int(2)\",\"created_at\":\"datetime\",\"updated_at\":\"datetime\",\"gmtcreated\":\"timestamp\",\"gmtupdated\":\"timestamp\",\"member_price\":\"decimal(10,2)\"},\"old\":[{\"status\":\"1\",\"updated_at\":\"2021-01-12 22:41:26\",\"gmtupdated\":\"2021-01-12 22:41:26\"}],\"pkNames\":[\"id\"],\"sql\":\"\",\"sqlType\":{\"id\":4,\"db_id\":4,\"table_id\":4,\"goods_internal_id\":12,\"group_id\":12,\"price\":3,\"status\":4,\"created_at\":93,\"updated_at\":93,\"gmtcreated\":93,\"gmtupdated\":93,\"member_price\":3},\"table\":\"partner_store_goods\",\"ts\":1610462572548,\"type\":\"UPDATE\"}";

    private static final String standard = "[{\"redisManual\":{\"approvalNumber\":\"国药准字H41024448\",\"attentions\":\"1、服用30分钟后，尿液呈荧光黄绿色，属正常药物颜色。\\n2、当药品性状发生改变时禁止使用。\",\"clinicalClassification\":\"化学药品\",\"commonName\":\"维酶素片\",\"composition\":\"本品系以黄豆为主要原料，经生物发酵后精制加工而成的一种复方制剂。其主要成分为核黄素及核黄素的衍生物。其中维生素12种，以B2和VE含量最多，氨基酸18种，微量元素23种，其他尚包括糖类、粗纤维等。\",\"cureDisease\":\"用于萎缩性胃炎。亦可用于食道上皮增生症。\",\"dosage\":\"口服，一次4～6片，一日3次。\",\"drugName\":\"维酶素片\",\"drugType\":\"处方药\",\"enName\":\"\",\"geriatricUse\":\"老人应在专业医师指导下使用。\",\"id\":\"115687\",\"indications\":\"用于萎缩性胃炎。亦可用于食道上皮增生症。\",\"interaction\":\"如与其他药物同时使用可能会发生药物相互作用，详情请咨询医师或药师\",\"manufacturer\":\"新乡恒久远药业有限公司(国产)\",\"overDosage\":\"\",\"packaging\":\"\",\"pediatricUse\":\"儿童必须在成人监护下使用,遵医嘱。\",\"pharmacologicalEffects\":\"维生素B2转化为黄素单核苷酸(flavinemononucleotide，FMN)和黄素腺嘌呤二核苷酸(flavineadeninedenucleotide，FAD)，均为组织呼吸的重要辅酶，并可激活维生素B6，将色氨酸转化为烟酸，并可能与维持红细胞的完整性有关。\",\"pinyinName\":\"\",\"pregnancyAndNursingMothers\":\"尚不明确\",\"prescriptionType\":\"1\",\"relativeSickness\":\"萎缩性胃炎,胃炎,\",\"specification\":\"0.2g*100s\",\"storage\":\"密封，凉暗处保存。\",\"taboo\":\"对本品过敏者禁用。\",\"validity\":\"24个月\"},\"redisStandard\":{\"approvalNumber\":\"国药准字H41024448\",\"goodsName\":\"维酶素片\",\"id\":\"40\",\"redisAttrs\":[],\"redisCates\":[{\"id\":\"11976\",\"pids\":\"0,1,11412,11414,11447,11596,11976\",\"title\":\"酶制剂\"}],\"searchKeywords\":\"胃酸过多、反酸烧心\",\"spuId\":\"67560\",\"status\":\"0\",\"subTitle\":\"1、服用30分钟后，尿液呈荧光黄绿色，属正常药物颜色。\\n2、当药品性状发生改变时禁止使用。,用于萎缩性胃炎。亦可用于食道上皮增生症。\",\"tradeCode\":\"0000000010901\",\"urls\":\"http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557899873650.jpg,http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557899876361.jpg,http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557899873650.jpg,http://uniondrug-release.oss-cn-shanghai.aliyuncs.com/oss/upload/file/goods/1557899876361.jpg\"}}]";

    private static final String matchcode = "{\"skuNo\":\"124952-G2208989\",\"tradeCode\":\"6956941600020\"}";

    public static void main(String[] args) {
        Properties props = new Properties();
        props.put("bootstrap.servers", "192.168.3.212:9092");
        props.put("acks", "all");
        props.put("retries", 0);
        props.put("batch.size", 16384);
        props.put("linger.ms", 1);
        props.put("buffer.memory", 33554432);
        props.put("key.serializer", "org.apache.kafka.common.serialization.StringSerializer");
        props.put("value.serializer", "org.apache.kafka.common.serialization.StringSerializer");

        Producer<String, String> producer = new KafkaProducer<>(props);
//        producer.send(new ProducerRecord<>("topic_standard_goods", standard));
//        producer.send(new ProducerRecord<>("polardb_binlog_test", update));
        producer.send(new ProducerRecord<>("goodscenter-match-code", matchcode));
        producer.close();
    }


}
