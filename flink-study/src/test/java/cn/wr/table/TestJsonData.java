package cn.wr.table;

import org.apache.flink.formats.json.JsonRowDataDeserializationSchema;
import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.JsonNode;
import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.ObjectMapper;
import org.apache.flink.shaded.jackson2.com.fasterxml.jackson.databind.node.JsonNodeType;
import org.junit.Test;

import java.io.IOException;
import java.util.regex.Pattern;

/**
 * @author RWang
 * @Date 2022/3/2
 */

public class TestJsonData {

    @Test
    public void testJsonData() throws IOException {
        String canalJson = "{\"data\":[{\"id\":\"2112123123396313131\",\"mainOrderNo\":\"82022301641388281719\",\"mainShortNo\":\"64138828789\",\"orderNo\":\"82022301641388281719\",\"shortNo\":\"64138828789\",\"parentOrderNo\":null,\"channel\":\"17\",\"channelVersion\":\"uf.v1\",\"equityId\":\"0\",\"levelType\":\"1\",\"orderStatus\":\"2\",\"viewStatus\":\"4\",\"subViewStatus\":\"200\",\"itemType\":null,\"subItemtype\":null,\"refundStatus\":\"-1\",\"cancelStatus\":\"0\",\"pushStatus\":\"0\",\"syncStatus\":\"0\",\"auditStatus\":\"0\",\"saleAmount\":\"20.0\",\"directAmount\":\"0.0\",\"integralCashAmount\":\"0.0\",\"creditAmount\":\"0.0\",\"couponAmount\":\"0.0\",\"activityAmount\":\"0.0\",\"feeAmount\":\"0.0\",\"totalAmount\":\"20.0\",\"couponTotalAmount\":\"0.0\",\"couponOrderAmount\":\"0.0\",\"payAmount\":\"20.0\",\"billAmount\":\"20.0\",\"couponId\":\"0\",\"itemQuantity\":\"0.0\",\"goodsQuantity\":\"0.0\",\"serviceQuantity\":\"0.0\",\"memberId\":\"15967643\",\"assistantId\":null,\"merchantId\":\"539\",\"merchantName\":\"药联健康\",\"merchantShortName\":\"药联健康\",\"merchantType\":\"1\",\"cooperationCode\":\"2018090300053853697066\",\"balanceDiscount\":null,\"erpSn\":null,\"erpImage\":null,\"storeId\":\"74596\",\"storeName\":\"增值服务商城\",\"storelocation\":\"0.000000,0.000000\",\"storeinternalId\":\"juyin\",\"storeCode\":\"2019051500053985174370\",\"manualCreated\":\"2022-02-23 16:48:28\",\"gmtCreated\":\"2022-02-23 16:48:28\",\"gmtUpdated\":\"2022-02-23 16:48:35\",\"gmtPaid\":\"2022-02-23 16:48:34\",\"gmtPayExpired\":\"2022-02-23 17:18:28\",\"gmtCanceled\":null,\"cancelReason\":\"\",\"gmtFrontCreated\":\"2022-02-23 08:48:28\",\"gmtFrontScan\":null,\"remark\":null,\"cancelTimeOut\":\"30\",\"orderMethod\":\"3\",\"internalCode\":\"yaolianjiankang\",\"canRefund\":\"1\",\"receiveType\":\"0\",\"gmtReceive\":null,\"receiveTimeOut\":null,\"deliverMethod\":\"7\",\"hidden\":null,\"isSelfToEquity\":null,\"hasHx\":\"0\",\"packageOrder\":null,\"needOrderTaking\":\"0\",\"needPush\":\"1\",\"logisticProvider\":null}],\"database\":\"cn_uniondrug_middleend_ordercenter\",\"es\":1645606115000,\"id\":22901,\"isDdl\":false,\"mysqlType\":{\"id\":\"bigint(20)\",\"mainOrderNo\":\"char(20)\",\"mainShortNo\":\"char(16)\",\"orderNo\":\"char(20)\",\"shortNo\":\"varchar(32)\",\"parentOrderNo\":\"char(20)\",\"channel\":\"tinyint(2)\",\"channelVersion\":\"varchar(10)\",\"equityId\":\"char(20)\",\"levelType\":\"tinyint(2)\",\"orderStatus\":\"tinyint(2)\",\"viewStatus\":\"tinyint(2)\",\"subViewStatus\":\"smallint(3) unsigned zerofill\",\"itemType\":\"tinyint(2)\",\"subItemtype\":\"tinyint(2) unsigned\",\"refundStatus\":\"tinyint(2)\",\"cancelStatus\":\"tinyint(2)\",\"pushStatus\":\"tinyint(2)\",\"syncStatus\":\"tinyint(2)\",\"auditStatus\":\"tinyint(2)\",\"saleAmount\":\"decimal(10,2)\",\"directAmount\":\"decimal(10,2)\",\"integralCashAmount\":\"decimal(10,2)\",\"creditAmount\":\"decimal(10,2)\",\"couponAmount\":\"decimal(10,2)\",\"activityAmount\":\"decimal(10,2)\",\"feeAmount\":\"decimal(10,2)\",\"totalAmount\":\"decimal(10,2)\",\"couponTotalAmount\":\"decimal(10,2)\",\"couponOrderAmount\":\"decimal(10,2)\",\"payAmount\":\"decimal(10,2)\",\"billAmount\":\"decimal(10,2)\",\"couponId\":\"char(20)\",\"itemQuantity\":\"decimal(10,2)\",\"goodsQuantity\":\"decimal(10,2)\",\"serviceQuantity\":\"decimal(10,2)\",\"memberId\":\"bigint(20)\",\"assistantId\":\"bigint(20)\",\"merchantId\":\"bigint(20)\",\"merchantName\":\"varchar(64)\",\"merchantShortName\":\"varchar(64)\",\"merchantType\":\"tinyint(2)\",\"cooperationCode\":\"varchar(255)\",\"balanceDiscount\":\"decimal(10,2)\",\"erpSn\":\"varchar(255)\",\"erpImage\":\"varchar(255)\",\"storeId\":\"bigint(20)\",\"storeName\":\"varchar(128)\",\"storelocation\":\"varchar(255)\",\"storeinternalId\":\"varchar(255)\",\"storeCode\":\"varchar(255)\",\"manualCreated\":\"timestamp\",\"gmtCreated\":\"timestamp\",\"gmtUpdated\":\"timestamp\",\"gmtPaid\":\"datetime\",\"gmtPayExpired\":\"datetime\",\"gmtCanceled\":\"datetime\",\"cancelReason\":\"varchar(255)\",\"gmtFrontCreated\":\"datetime\",\"gmtFrontScan\":\"datetime\",\"remark\":\"varchar(255)\",\"cancelTimeOut\":\"int(4)\",\"orderMethod\":\"tinyint(2)\",\"internalCode\":\"varchar(128)\",\"canRefund\":\"tinyint(2)\",\"receiveType\":\"tinyint(2)\",\"gmtReceive\":\"datetime\",\"receiveTimeOut\":\"int(4)\",\"deliverMethod\":\"tinyint(2)\",\"hidden\":\"tinyint(2)\",\"isSelfToEquity\":\"tinyint(2)\",\"hasHx\":\"tinyint(2)\",\"packageOrder\":\"tinyint(2)\",\"needOrderTaking\":\"tinyint(2)\",\"needPush\":\"tinyint(2)\",\"logisticProvider\":\"tinyint(2)\"},\"old\":[{\"viewStatus\":\"0\",\"gmtUpdated\":\"2022-02-23 16:48:34\"}],\"pkNames\":[\"id\"],\"sql\":\"\",\"sqlType\":{\"id\":-5,\"mainOrderNo\":1,\"mainShortNo\":1,\"orderNo\":1,\"shortNo\":12,\"parentOrderNo\":1,\"channel\":-6,\"channelVersion\":12,\"equityId\":1,\"levelType\":-6,\"orderStatus\":-6,\"viewStatus\":-6,\"subViewStatus\":5,\"itemType\":-6,\"subItemtype\":-6,\"refundStatus\":-6,\"cancelStatus\":-6,\"pushStatus\":-6,\"syncStatus\":-6,\"auditStatus\":-6,\"saleAmount\":3,\"directAmount\":3,\"integralCashAmount\":3,\"creditAmount\":3,\"couponAmount\":3,\"activityAmount\":3,\"feeAmount\":3,\"totalAmount\":3,\"couponTotalAmount\":3,\"couponOrderAmount\":3,\"payAmount\":3,\"billAmount\":3,\"couponId\":1,\"itemQuantity\":3,\"goodsQuantity\":3,\"serviceQuantity\":3,\"memberId\":-5,\"assistantId\":-5,\"merchantId\":-5,\"merchantName\":12,\"merchantShortName\":12,\"merchantType\":-6,\"cooperationCode\":12,\"balanceDiscount\":3,\"erpSn\":12,\"erpImage\":12,\"storeId\":-5,\"storeName\":12,\"storelocation\":12,\"storeinternalId\":12,\"storeCode\":12,\"manualCreated\":93,\"gmtCreated\":93,\"gmtUpdated\":93,\"gmtPaid\":93,\"gmtPayExpired\":93,\"gmtCanceled\":93,\"cancelReason\":12,\"gmtFrontCreated\":93,\"gmtFrontScan\":93,\"remark\":12,\"cancelTimeOut\":4,\"orderMethod\":-6,\"internalCode\":12,\"canRefund\":-6,\"receiveType\":-6,\"gmtReceive\":93,\"receiveTimeOut\":4,\"deliverMethod\":-6,\"hidden\":-6,\"isSelfToEquity\":-6,\"hasHx\":-6,\"packageOrder\":-6,\"needOrderTaking\":-6,\"needPush\":-6,\"logisticProvider\":-6},\"table\":\"order\",\"ts\":1645606115256,\"type\":\"UPDATE\"}";
        byte[] bytes = canalJson.getBytes();
        ObjectMapper objectMapper = new ObjectMapper();
        JsonNode jsonNode = objectMapper.readTree(bytes);
        JsonRowDataDeserializationSchema jsonDeserializer = null;
//        JsonRowDataDeserializationSchema jsonRowDataDeserializationSchema = new JsonRowDataDeserializationSchema();
//        jsonDeserializer.deserialize(bytes)


        System.out.println("ss");
    }
}
